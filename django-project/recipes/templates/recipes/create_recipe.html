<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .container {
        max-width: 800px;
        width: 100%;
      }
      h1 {
        text-align: center;
        margin-bottom: 20px;
      }
      form {
        background: #f9f9f9;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .form-group {
        margin-bottom: 20px;
      }
      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
      }
      input[type="text"],
      input[type="url"],
      input[type="file"],
      textarea {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
      }
      textarea {
        resize: vertical;
      }
      .ingredient-row,
      .instruction-row {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
        align-items: flex-start;
      }
      .ingredient-row input,
      .instruction-row textarea {
        flex: 1;
      }
      .ingredient-row input[name="ingredient_amount"] {
        flex: 0 0 150px;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 4px;
        margin-top: 10px;
      }
      button:hover {
        background: #45a049;
      }
      .add-btn {
        background: #2196F3;
        margin-bottom: 20px;
      }
      .add-btn:hover {
        background: #0b7dda;
      }
      .remove-btn {
        background: #f44336;
        padding: 5px 10px;
        font-size: 12px;
      }
      .remove-btn:hover {
        background: #da190b;
      }
      .submit-btn {
        width: 100%;
        background: #4CAF50;
        padding: 12px;
        font-size: 18px;
      }
      a {
        color: #2196F3;
        text-decoration: none;
        display: inline-block;
        margin-top: 20px;
      }
      a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Create New Recipe</h1>
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="form-group">
          <label for="id_title">Recipe Title *</label>
          {{ recipe_form.title }}
        </div>
        
        <div class="form-group">
          <label for="id_description">Description *</label>
          {{ recipe_form.description }}
        </div>
        
        <div class="form-group">
          <label for="id_image">Upload Image (optional)</label>
          {{ recipe_form.image }}
        </div>
        
        <div class="form-group">
          <label for="id_image_url">Or Image URL (optional)</label>
          {{ recipe_form.image_url }}
        </div>
        
        <h3>Ingredients</h3>
        <div id="ingredients-container">
          <div class="ingredient-row">
            <input type="text" name="ingredient_name" placeholder="Ingredient name" required>
            <input type="text" name="ingredient_amount" placeholder="Amount (e.g., 2 cups)">
            <button type="button" class="remove-btn" onclick="removeIngredient(this)" style="display:none;">Remove</button>
          </div>
        </div>
        <button type="button" class="add-btn" onclick="addIngredient()">+ Add Ingredient</button>
        
        <h3>Instructions</h3>
        <div id="instructions-container">
          <div class="instruction-row">
            <textarea name="instruction" placeholder="Enter instruction step..." rows="2" required></textarea>
            <button type="button" class="remove-btn" onclick="removeInstruction(this)" style="display:none;">Remove</button>
          </div>
        </div>
        <button type="button" class="add-btn" onclick="addInstruction()">+ Add Instruction</button>
        
        <button type="submit" class="submit-btn">Create Recipe</button>
      </form>
      <a href="{% url 'home' %}">‚Üê Back to Home</a>
    </div>
    
    <script>
      function addIngredient() {
        const container = document.getElementById('ingredients-container');
        const newRow = document.createElement('div');
        newRow.className = 'ingredient-row';
        newRow.innerHTML = `
          <input type="text" name="ingredient_name" placeholder="Ingredient name">
          <input type="text" name="ingredient_amount" placeholder="Amount (e.g., 2 cups)">
          <button type="button" class="remove-btn" onclick="removeIngredient(this)">Remove</button>
        `;
        container.appendChild(newRow);
        updateRemoveButtons('ingredients-container');
      }
      
      function removeIngredient(btn) {
        btn.parentElement.remove();
        updateRemoveButtons('ingredients-container');
      }
      
      function addInstruction() {
        const container = document.getElementById('instructions-container');
        const newRow = document.createElement('div');
        newRow.className = 'instruction-row';
        newRow.innerHTML = `
          <textarea name="instruction" placeholder="Enter instruction step..." rows="2"></textarea>
          <button type="button" class="remove-btn" onclick="removeInstruction(this)">Remove</button>
        `;
        container.appendChild(newRow);
        updateRemoveButtons('instructions-container');
      }
      
      function removeInstruction(btn) {
        btn.parentElement.remove();
        updateRemoveButtons('instructions-container');
      }
      
      function updateRemoveButtons(containerId) {
        const container = document.getElementById(containerId);
        const rows = container.children;
        // Show remove button if more than one row
        for (let i = 0; i < rows.length; i++) {
          const removeBtn = rows[i].querySelector('.remove-btn');
          if (removeBtn) {
            removeBtn.style.display = rows.length > 1 ? 'block' : 'none';
          }
        }
      }
      
      // Initialize remove buttons visibility
      document.addEventListener('DOMContentLoaded', function() {
        updateRemoveButtons('ingredients-container');
        updateRemoveButtons('instructions-container');
      });
    </script>
  </body>
</html>

